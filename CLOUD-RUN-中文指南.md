# Google Cloud Run éƒ¨ç½²æŒ‡å— (ä¸­æ–‡è¯¦è§£)

## ğŸ¯ ä»€ä¹ˆæ˜¯ Cloud Runï¼Ÿ

**Cloud Run** æ˜¯ Google æ¨å‡ºçš„"æ— æœåŠ¡å™¨"å®¹å™¨å¹³å°ï¼Œè®©ä½ ä¸“æ³¨å†™ä»£ç ï¼Œä¸ç”¨ç®¡æœåŠ¡å™¨ã€‚

### ğŸ”¥ ä¸ºä»€ä¹ˆæ–°æ‰‹åº”è¯¥é€‰æ‹© Cloud Runï¼Ÿ

#### 1. è¶…çº§ç®€å•

```txt
ä¼ ç»Ÿéƒ¨ç½²æ–¹æ³•:
è´­ä¹°æœåŠ¡å™¨ â†’ å®‰è£…æ“ä½œç³»ç»Ÿ â†’ é…ç½®ç¯å¢ƒ â†’ å®‰è£…æ•°æ®åº“ â†’ é…ç½®é˜²ç«å¢™ â†’ éƒ¨ç½²ä»£ç  â†’ ç›‘æ§ç»´æŠ¤
â° éœ€è¦å‡ å¤©æ—¶é—´å­¦ä¹ 

Cloud Run éƒ¨ç½²:
å†™å¥½ä»£ç  â†’ ä¸€æ¡å‘½ä»¤ä¸Šä¼  â†’ å®Œæˆï¼
â° åªéœ€è¦5åˆ†é’Ÿ
```

#### 2. çœé’±åˆ°æè‡´

- **å…è´¹é¢åº¦**: æ¯æœˆ 200ä¸‡æ¬¡ è¯·æ±‚å…è´¹
- **æŒ‰éœ€ä»˜è´¹**: æ²¡äººè®¿é—® = ä¸èŠ±é’±
- **è‡ªåŠ¨ä¼‘çœ **: æ— æµé‡æ—¶è‡ªåŠ¨å…³é—­ï¼Œè´¹ç”¨ä¸ºé›¶

#### 3. è‡ªåŠ¨æ‰©å±•

```txt
ç”¨æˆ·é‡å°‘: 1ä¸ªå®¹å™¨è¿è¡Œ
ç”¨æˆ·é‡å¤š: è‡ªåŠ¨å¯åŠ¨æ›´å¤šå®¹å™¨
æ²¡ç”¨æˆ·: è‡ªåŠ¨å…³é—­æ‰€æœ‰å®¹å™¨ (è´¹ç”¨ä¸ºé›¶)
```

## ğŸ“Š è´¹ç”¨å¯¹æ¯” (ä¸ªäººé¡¹ç›®)

| éƒ¨ç½²æ–¹å¼ | æœˆè´¹ç”¨ | ç»´æŠ¤å·¥ä½œ | é€‚åˆäººç¾¤ |
|---------|--------|----------|----------|
| äº‘æœåŠ¡å™¨ | Â¥50-200 | éœ€è¦ç»´æŠ¤ | æœ‰ç»éªŒå¼€å‘è€… |
| Cloud Run | Â¥0-20 | é›¶ç»´æŠ¤ | **æ–°æ‰‹æ¨è** |
| å…±äº«ä¸»æœº | Â¥30-100 | é™åˆ¶å¾ˆå¤š | é™æ€ç½‘ç«™ |

## ğŸš€ éƒ¨ç½²ä½ çš„ Stock Tracker åº”ç”¨

### ç¬¬ä¸€æ­¥: æ³¨å†Œ Google Cloud (5åˆ†é’Ÿ)

1. è®¿é—® [cloud.google.com](https://cloud.google.com)
2. ç‚¹å‡»"å…è´¹å¼€å§‹ä½¿ç”¨"
3. ç”¨Gmailè´¦å·ç™»å½•
4. éªŒè¯æ‰‹æœºå·ç 
5. ç»‘å®šä¿¡ç”¨å¡ (ä¸ä¼šæ‰£è´¹ï¼Œåªæ˜¯éªŒè¯èº«ä»½)
6. **è·å¾— $300 å…è´¹é¢åº¦** (å¤Ÿç”¨1-2å¹´)

### ç¬¬äºŒæ­¥: å®‰è£…å·¥å…· (3åˆ†é’Ÿ)

#### macOS ç”¨æˆ·:

**æ–¹æ³•ä¸€: å®˜æ–¹å®‰è£…åŒ… (æ¨èï¼Œæ— éœ€Homebrew)**

1. **ä¸‹è½½ Google Cloud SDK**:
```bash
# ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ (Intel Mac)
curl -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-cli-darwin-x86_64.tar.gz

# å¦‚æœæ˜¯ Apple Silicon Mac (M1/M2)
curl -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-cli-darwin-arm.tar.gz
```

2. **å®‰è£…å’Œé…ç½®**:

```bash
# è§£å‹åˆ°å®¶ç›®å½•
tar -xzf google-cloud-cli-darwin-*.tar.gz

# è¿è¡Œå®‰è£…è„šæœ¬
./google-cloud-sdk/install.sh

# é‡å¯ç»ˆç«¯æˆ–é‡æ–°åŠ è½½é…ç½®
source ~/.bash_profile  # å¦‚æœä½¿ç”¨ bash
source ~/.zshrc         # å¦‚æœä½¿ç”¨ zsh

# åˆå§‹åŒ–è®¤è¯
gcloud init
```

**æ–¹æ³•äºŒ: ä¸€é”®å®‰è£…è„šæœ¬ (è‡ªåŠ¨åŒ–)**

```bash
# è‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…
curl https://sdk.cloud.google.com | bash
exec -l $SHELL
gcloud init
```

**æ–¹æ³•ä¸‰: å¦‚æœä½ æœ‰ Homebrew**

```bash
# ä½¿ç”¨Homebrewå®‰è£… (éœ€è¦å…ˆå®‰è£…Homebrew)
brew install google-cloud-sdk
```

**å®‰è£… Firebase CLI**

```bash
# éœ€è¦å…ˆå®‰è£… Node.js (å¦‚æœè¿˜æ²¡æœ‰)
# ä» https://nodejs.org ä¸‹è½½å®‰è£…

# å®‰è£… Firebase CLI
npm install -g firebase-tools
```

#### Windows ç”¨æˆ·

1. ä¸‹è½½ [Google Cloud SDK](https://cloud.google.com/sdk/docs/install)
2. è¿è¡Œå®‰è£…ç¨‹åº
3. æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼Œè¿è¡Œ: `npm install -g firebase-tools`

### ç¬¬ä¸‰æ­¥: ä¸€é”®éƒ¨ç½² (2åˆ†é’Ÿ)

åœ¨ä½ çš„é¡¹ç›®ç›®å½•è¿è¡Œ:

```bash
# è‡ªåŠ¨éƒ¨ç½²è„šæœ¬
./deploy-gcp.sh
```

**å°±è¿™ä¹ˆç®€å•ï¼** è„šæœ¬ä¼šè‡ªåŠ¨:

- åˆ›å»º Google Cloud é¡¹ç›®
- éƒ¨ç½²åç«¯åˆ° Cloud Run
- éƒ¨ç½²å‰ç«¯åˆ° Firebase
- é…ç½®åŸŸåå’ŒHTTPS

### ç¬¬å››æ­¥: æŸ¥çœ‹ç»“æœ

éƒ¨ç½²å®Œæˆåï¼Œä½ ä¼šå¾—åˆ°:

```txt
âœ… åç«¯API: https://stock-tracker-backend-xxx-uc.a.run.app
âœ… å‰ç«¯ç½‘ç«™: https://your-project.web.app
âœ… å…è´¹HTTPSè¯ä¹¦
âœ… å…¨çƒCDNåŠ é€Ÿ
```

## ğŸ“± æ‰‹åŠ¨éƒ¨ç½²è¯¦è§£ (å¦‚æœè‡ªåŠ¨è„šæœ¬å¤±è´¥)

### 1. åˆå§‹åŒ–é¡¹ç›®
```bash
# ç™»å½•Google Cloud
gcloud auth login

# åˆ›å»ºæ–°é¡¹ç›® (é¡¹ç›®åå¿…é¡»å…¨çƒå”¯ä¸€)
gcloud projects create stock-tracker-20250713

# è®¾ç½®å½“å‰é¡¹ç›®
gcloud config set project stock-tracker-20250713
```

### 2. å¯ç”¨éœ€è¦çš„æœåŠ¡
```bash
# å¯ç”¨ Cloud Run (è¿è¡Œåç«¯)
gcloud services enable run.googleapis.com

# å¯ç”¨ Cloud Build (è‡ªåŠ¨æ„å»º)
gcloud services enable cloudbuild.googleapis.com
```

### 3. éƒ¨ç½²åç«¯
```bash
cd backend

# ä¸€æ¡å‘½ä»¤éƒ¨ç½²åˆ° Cloud Run
gcloud run deploy stock-tracker-backend \
  --source . \
  --platform managed \
  --region us-central1 \
  --allow-unauthenticated \
  --memory 512Mi \
  --max-instances 10
```

### 4. éƒ¨ç½²å‰ç«¯
```bash
cd ../frontend

# ç™»å½•Firebase
firebase login

# åˆå§‹åŒ–Firebaseé¡¹ç›®
firebase init hosting

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# éƒ¨ç½²åˆ°Firebase
firebase deploy
```

## âš¡ Cloud Run çš„ç¥å¥‡ä¹‹å¤„

### è‡ªåŠ¨ç¼©æ”¾æ¼”ç¤º
```
è®¿é—®é‡: 0äºº     â†’ å®¹å™¨æ•°: 0ä¸ª  â†’ è´¹ç”¨: Â¥0
è®¿é—®é‡: 10äºº    â†’ å®¹å™¨æ•°: 1ä¸ª  â†’ è´¹ç”¨: Â¥0.01
è®¿é—®é‡: 1000äºº  â†’ å®¹å™¨æ•°: 10ä¸ª â†’ è´¹ç”¨: Â¥2
è®¿é—®é‡: 0äºº     â†’ å®¹å™¨æ•°: 0ä¸ª  â†’ è´¹ç”¨: Â¥0 (è‡ªåŠ¨å›åˆ°é›¶)
```

### å†·å¯åŠ¨ vs çƒ­å¯åŠ¨
- **å†·å¯åŠ¨**: ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œéœ€è¦1-3ç§’å¯åŠ¨å®¹å™¨
- **çƒ­å¯åŠ¨**: åç»­è®¿é—®ï¼Œç«‹å³å“åº” (<100ms)

## ğŸ› ï¸ ç›‘æ§å’Œç®¡ç†

### æŸ¥çœ‹åº”ç”¨çŠ¶æ€
```bash
# æŸ¥çœ‹ Cloud Run æœåŠ¡
gcloud run services list

# æŸ¥çœ‹æ—¥å¿—
gcloud logging read "resource.type=cloud_run_revision"

# æŸ¥çœ‹ç›‘æ§æ•°æ®
# è®¿é—®: https://console.cloud.google.com/run
```

### æ›´æ–°åº”ç”¨
```bash
# æ›´æ–°åç«¯
cd backend
gcloud run deploy stock-tracker-backend --source .

# æ›´æ–°å‰ç«¯
cd frontend
npm run build
firebase deploy
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æˆæœ¬ä¼˜åŒ–
- è®¾ç½®æœ€å¤§å®ä¾‹æ•°: `--max-instances 10`
- ä½¿ç”¨æœ€å°å†…å­˜: `--memory 512Mi`
- å¯ç”¨è‡ªåŠ¨ä¼‘çœ  (é»˜è®¤å¼€å¯)

### 2. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨ CDN (Firebase è‡ªå¸¦)
- å¯ç”¨ gzip å‹ç¼©
- ä¼˜åŒ–å®¹å™¨å¯åŠ¨æ—¶é—´

### 3. å®‰å…¨è®¾ç½®
- å¯ç”¨ HTTPS (è‡ªåŠ¨)
- é…ç½® CORS ç­–ç•¥
- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥

## â“ å¸¸è§é—®é¢˜è§£ç­”

### Q: ä¼šä¸ä¼šå¾ˆè´µï¼Ÿ
**A:** ä¸ªäººé¡¹ç›®åŸºæœ¬å…è´¹ã€‚å…è´¹é¢åº¦åŒ…æ‹¬:
- 200ä¸‡æ¬¡è¯·æ±‚/æœˆ
- 400,000 GB-ç§’è®¡ç®—æ—¶é—´
- å¯¹äº Stock Trackerï¼Œä¸€å¹´è´¹ç”¨ < Â¥100

### Q: å¦‚æœåº”ç”¨å´©æºƒäº†æ€ä¹ˆåŠï¼Ÿ
**A:** Cloud Run è‡ªåŠ¨é‡å¯ã€‚å¦‚æœé—®é¢˜æŒç»­ï¼Œä¼šæ˜¾ç¤ºé”™è¯¯é¡µé¢ï¼Œä½ å¯ä»¥æŸ¥çœ‹æ—¥å¿—ä¿®å¤ã€‚

### Q: å¯ä»¥è‡ªå®šä¹‰åŸŸåå—ï¼Ÿ
**A:** å¯ä»¥ï¼åœ¨ Firebase æ§åˆ¶å°æ·»åŠ ä½ çš„åŸŸåï¼ŒGoogle è‡ªåŠ¨é…ç½® HTTPSã€‚

### Q: æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ
**A:** å½“å‰æ˜¯å†…å­˜å­˜å‚¨ï¼Œé‡å¯ä¼šä¸¢å¤±ã€‚å¯ä»¥å‡çº§åˆ°:
- Cloud SQL (å…³ç³»æ•°æ®åº“)
- Firestore (NoSQL æ•°æ®åº“)
- Cloud Storage (æ–‡ä»¶å­˜å‚¨)

## ğŸ¤” Google Cloud æ³¨å†Œå¸¸è§é—®é¢˜

### æ³¨å†Œæ—¶ä¼šé—®ä»€ä¹ˆï¼Ÿ

å½“ä½ æ³¨å†Œ Google Cloud æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™äº›é—®é¢˜ï¼š

**1. "æ‚¨æƒ³ç”¨ Google Cloud åšä»€ä¹ˆï¼Ÿ"**
- é€‰æ‹©: **"æ„å»ºå’Œéƒ¨ç½²åº”ç”¨ç¨‹åº"** 
- æˆ–è€…: **"å­¦ä¹ å’Œå®éªŒ"**

**2. "æ‚¨çš„å…¬å¸è§„æ¨¡æ˜¯ï¼Ÿ"**
- é€‰æ‹©: **"ä¸ªäººå¼€å‘è€…"** æˆ– **"å°å‹ä¼ä¸š (1-10äºº)"**

**3. "æ‚¨ä¸»è¦ä½¿ç”¨ä»€ä¹ˆæŠ€æœ¯ï¼Ÿ"**
- é€‰æ‹©: **"Web åº”ç”¨"** å’Œ **"å®¹å™¨"**

**4. "æ‚¨çš„é¡¹ç›®ç±»å‹ï¼Ÿ"**
- é€‰æ‹©: **"æˆ‘æƒ³ä½¿ç”¨æ‰˜ç®¡å®¹å™¨æ„å»ºåº”ç”¨ç¨‹åº"** 
- è¿™æ­£å¥½å¯¹åº” Cloud Runï¼

**5. "æ‚¨çš„é¢„ç®—èŒƒå›´ï¼Ÿ"**
- é€‰æ‹©: **"æ¯æœˆ $0-50"** (å¯¹äºä¸ªäººé¡¹ç›®å®Œå…¨å¤Ÿç”¨)

### ä¿¡ç”¨å¡éªŒè¯è¯´æ˜

- **ä¸ä¼šæ‰£è´¹**: Google åªæ˜¯éªŒè¯èº«ä»½ï¼Œä¸ä¼šè‡ªåŠ¨æ‰£æ¬¾
- **$300 å…è´¹é¢åº¦**: æ³¨å†Œåç«‹å³è·å¾—ï¼Œå¤Ÿç”¨å¾ˆä¹…
- **å…è´¹å±‚**: å³ä½¿ç”¨å®Œ $300ï¼Œå¾ˆå¤šæœåŠ¡ä»ç„¶å…è´¹ä½¿ç”¨

### å¦‚æœæ²¡æœ‰ä¿¡ç”¨å¡æ€ä¹ˆåŠï¼Ÿ

1. **å€Ÿç”¨å®¶äººæœ‹å‹çš„å¡**: åªæ˜¯éªŒè¯ï¼Œä¸ä¼šæ‰£è´¹
2. **ä½¿ç”¨è™šæ‹Ÿä¿¡ç”¨å¡**: ä¸€äº›é“¶è¡Œæä¾›ä¸´æ—¶è™šæ‹Ÿå¡
3. **ç­‰æœ‰å¡å†æ³¨å†Œ**: Google Cloud ä¸ç€æ€¥ï¼Œéšæ—¶å¯ä»¥æ³¨å†Œ

---

**æ€»ç»“: Cloud Run è®©éƒ¨ç½²å˜å¾—åƒå‘å¾®ä¿¡ä¸€æ ·ç®€å•ï¼** ğŸš€
